<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width,initial-scale=1.0" />
    <title>Funnel Form </title>
    <style>
      @import url("https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700;800;900&display=swap");

      :root {
        --brand: #4caf50;
        --brand2: #4caf50;
        --text: #111827;
        --muted: #e5e7eb;
        --gt-dark: #1f2937;
        --gt-blue: #3b82f6;
        --gt-light: #e5e7eb;
      }

      * {
        margin: 0;
        padding: 0;
        box-sizing: border-box;
      }
      body {
        font-family: "Inter", -apple-system, BlinkMacSystemFont, sans-serif;
        background: #fff;
        min-height: 100vh;
        display: flex;
        align-items: center;
        justify-content: center;
        padding: 20px;
        position: relative;
        overflow: hidden;
      }

      .shape {
        position: fixed;
        border: 2px solid var(--brand);
        animation: shapeFloat 20s infinite linear;
        z-index: 2;
      }
      .shape-1 {
        width: 100px;
        height: 100px;
        top: 10%;
        left: 5%;
        animation-duration: 15s;
        transform: rotate(45deg);
      }
      .shape-2 {
        width: 60px;
        height: 60px;
        bottom: 20%;
        right: 10%;
        border-radius: 50%;
        animation-duration: 20s;
        animation-direction: reverse;
      }
      .shape-3 {
        width: 80px;
        height: 80px;
        top: 50%;
        right: 5%;
        transform: rotate(30deg);
        animation-duration: 25s;
      }
      @keyframes shapeFloat {
        0% {
          transform: rotate(0) translateY(0);
        }
        33% {
          transform: rotate(120deg) translateY(-20px);
        }
        66% {
          transform: rotate(240deg) translateY(20px);
        }
        100% {
          transform: rotate(360deg) translateY(0);
        }
      }

      .neon-line {
        position: fixed;
        height: 1px;
        background: linear-gradient(
          90deg,
          transparent,
          rgb(0, 255, 21),
          transparent
        );
        box-shadow: 0 0 10px white;
        opacity: 0.5;
        z-index: 3;
      }
      .neon-line-1 {
        width: 300px;
        top: 30%;
        left: -300px;
        animation: neonSlide 6s linear infinite;
      }
      .neon-line-2 {
        width: 200px;
        bottom: 40%;
        right: -200px;
        animation: neonSlideReverse 8s linear infinite;
      }
      @keyframes neonSlide {
        to {
          transform: translateX(calc(100vw + 600px));
        }
      }
      @keyframes neonSlideReverse {
        to {
          transform: translateX(calc(-100vw - 400px));
        }
      }

      .transition-overlay {
        position: fixed;
        top: 0;
        left: 0;
        width: 100%;
        height: 100%;
        background: #fff;
        z-index: 1000;
        display: none;
        pointer-events: none;
      }
      .transition-overlay.active {
        display: block;
        pointer-events: all;
      }
      .liquid-transition {
        position: absolute;
        width: 100%;
        height: 100%;
        overflow: hidden;
      }
      @keyframes liquidExpand {
        0% {
          transform: scale(0);
          opacity: 1;
        }
        60% {
          transform: scale(30);
          opacity: 0.8;
        }
        100% {
          transform: scale(50);
          opacity: 0;
        }
      }
      .transition-loader {
        position: absolute;
        top: 50%;
        left: 50%;
        transform: translate(-50%, -50%);
        opacity: 0;
      }
      .transition-loader.show {
        animation: loaderFade 1.5s ease-in-out;
      }
      @keyframes loaderFade {
        0%,
        100% {
          opacity: 0;
        }
        50% {
          opacity: 1;
        }
      }
      .loader-ring {
        width: 60px;
        height: 60px;
        border: 3px solid rgba(171, 255, 0, 0.2);
        border-top-color: var(--brand2);
        border-radius: 50%;
        animation: spin 1s linear infinite;
      }
      @keyframes spin {
        to {
          transform: rotate(360deg);
        }
      }

      .container {
        max-width: 600px;
        width: 100%;
        position: relative;
        z-index: 10;
        perspective: 2000px;
      }

      .form-card {
        backdrop-filter: blur(10px);
        border-radius: 30px;
        padding: 60px;
        position: relative;
        transform-style: preserve-3d;
     }
      @keyframes cardEntrance {
        0% {
          opacity: 0;
          transform: scale(0.5) rotateY(90deg);
        }
        100% {
          opacity: 1;
          transform: scale(1) rotateY(0);
        }
      }

      .step {
        display: none;
        animation: stepFadeIn 0.5s ease-out;
        max-height: 70vh;
        overflow-y: auto;
        padding-right: 10px;
      }
      .step.active {
        display: block;
      }
      @keyframes stepFadeIn {
        from {
          opacity: 0;
          transform: translateX(30px);
        }
        to {
          opacity: 1;
          transform: translateX(0);
        }
      }

      .step::-webkit-scrollbar {
        width: 8px;
      }
      .step::-webkit-scrollbar-track {
        background: rgba(0, 0, 0, 0.05);
        border-radius: 4px;
      }
      .step::-webkit-scrollbar-thumb {
        background: #000000;
        border-radius: 4px;
      }
      .step::-webkit-scrollbar-thumb:hover {
        background: #333333;
      }
      .step.no-scroll {
        overflow-y: hidden;
        padding-right: 0;
      }
      .step.no-scroll::-webkit-scrollbar {
        display: none;
      }

      .progress-container {
        position: absolute;
        top: -50px;
        left: 50%;
        transform: translateX(-50%);
        display: none;
        gap: 30px;
        align-items: center;
      }
      .progress-step {
        width: 12px;
        height: 12px;
        border-radius: 50%;
        background: rgba(255, 255, 255, 0.1);
        border: 2px solid rgba(255, 255, 255, 0.2);
        position: relative;
        transition: all 0.5s cubic-bezier(0.175, 0.885, 0.32, 1.275);
      }
      .progress-step.active {
        background: var(--brand);
        border-color: var(--brand);
        box-shadow: 0 0 30px var(--brand),
          inset 0 0 10px rgba(255, 255, 255, 0.5);
        animation: stepPulse 1.5s ease-in-out infinite;
      }
      @keyframes stepPulse {
        0%,
        100% {
          transform: scale(1);
          box-shadow: 0 0 30px var(--brand),
            inset 0 0 10px rgba(255, 255, 255, 0.5);
        }
        50% {
          transform: scale(1.3);
          box-shadow: 0 0 50px var(--brand),
            inset 0 0 20px rgba(255, 255, 255, 0.7);
        }
      }
      .progress-step.completed {
        background: var(--brand);
        border-color: var(--brand);
      }
      .progress-step::after {
        content: "";
        position: absolute;
        width: 30px;
        height: 2px;
        background: rgba(255, 255, 255, 0.1);
        left: 20px;
        top: 50%;
        transform: translateY(-50%);
      }
      .progress-step:last-child::after {
        display: none;
      }
      .progress-step.active::after {
        background: linear-gradient(90deg, var(--brand), transparent);
      }

      .top-progress {
        display: block;
        margin-bottom: 24px;
      }
      .progress-header {
        display: flex;
        justify-content: space-between;
        align-items: center;
        margin-bottom: 8px;
        font-weight: 700;
        color: #000;
        font-size: 13px;
      }
      .progress-bar {
        width: 100%;
        height: 8px;
        background: rgba(0, 0, 0, 0.1);
        border-radius: 999px;
        overflow: hidden;
      }
      .progress-fill {
        height: 100%;
        background: var(--brand);
        width: 0;
        transition: width 0.3s ease;
      }

      .brand-tagline {
        text-align: center;
        font-size: 11px;
        color: #000;
        letter-spacing: 2px;
        text-transform: uppercase;
        font-weight: 700;
        margin-bottom: 20px;
        opacity: 0;
        animation: fadeIn 0.8s ease-out 0.5s forwards;
      }
      @keyframes fadeIn {
        to {
          opacity: 1;
        }
      }
      h1 {
        font-size: 42px;
        font-weight: 900;
        line-height: 1.1;
        text-align: center;
        margin-bottom: 20px;
        position: relative;
      }
      .text-white {
        color: #000;
        display: block;
        opacity: 0;
        animation: wordSlide 0.6s cubic-bezier(0.175, 0.885, 0.32, 1.275) 0.8s
          forwards;
      }
      .text-green {
        color: var(--brand);
        display: block;
        font-size: 48px;
        opacity: 0;
        animation: wordSlide 0.6s cubic-bezier(0.175, 0.885, 0.32, 1.275) 1s
          forwards;
      }
      @keyframes wordSlide {
        from {
          opacity: 0;
          transform: translateX(-30px) rotateY(-30deg);
        }
        to {
          opacity: 1;
          transform: translateX(0) rotateY(0);
        }
      }
      h2 {
        font-size: 32px;
        font-weight: 700;
        color: #2b2a2a;
        margin-bottom: 20px;
        text-align: center;
      }
      .description {
        font-size: 16px;
        line-height: 1.8;
        color: #000;
        text-align: center;
        margin-bottom: 30px;
        max-width: 450px;
        margin-left: auto;
        margin-right: auto;
        opacity: 0;
        animation: fadeInUp 0.8s ease-out 1.2s forwards;
      }
      @keyframes fadeInUp {
        to {
          opacity: 1;
          transform: translateY(0);
        }
        from {
          opacity: 0;
          transform: translateY(30px);
        }
      }
      .description strong {
        color: var(--brand);
        font-weight: 700;
      }

      .challenge-grid {
        display: grid;
        gap: 16px;
        margin-bottom: 8px;
      }
      .challenge-card {
        background: rgba(255, 255, 255, 0.05);
        border: 2px solid rgba(0, 0, 0, 0.1);
        border-radius: 12px;
        padding: 20px;
        color: rgba(0, 0, 0, 0.9);
        font-size: 16px;
        font-weight: 600;
        cursor: pointer;
        text-align: center;
        transition: all 0.3s cubic-bezier(0.175, 0.885, 0.32, 1.275);
      }
      .challenge-card:hover {
        background: rgba(171, 255, 0, 0.1);
        border-color: var(--brand);
        transform: translateY(-2px);
        box-shadow: 0 10px 30px rgba(171, 255, 0, 0.2);
      }
      .challenge-card.selected {
        background: rgba(171, 255, 0, 0.2);
        border-color: var(--brand);
        color: var(--brand);
      }

      .form-group {
        margin-bottom: 16px;
        position: relative;
      }
      label {
        display: block;
        color: rgba(0, 0, 0, 0.9);
        font-size: 14px;
        font-weight: 600;
        margin-bottom: 8px;
      }
      input[type="text"],
      input[type="number"],
      input[type="email"],
      input[type="url"],
      input[type="tel"],
      select {
        width: 100%;
        padding: 16px;
        background: rgba(0, 0, 0, 0.05);
        border: 1px solid rgba(0, 0, 0, 0.2);
        border-radius: 12px;
        color: #000;
        font-size: 16px;
        transition: all 0.3s ease;
      }
      input:focus,
      select:focus {
        outline: none;
        border-color: var(--brand);
        background: rgba(0, 0, 0, 0.08);
        box-shadow: 0 0 20px rgba(171, 255, 0, 0.2);
      }
      input::placeholder {
        color: rgba(0, 0, 0, 0.4);
      }

      .input-error {
        border-color: #ef4444 !important;
        background: rgba(239, 68, 68, 0.06) !important;
      }
      .error-text {
        font-size: 12px;
        color: #ef4444;
        margin-top: 6px;
      }
      .error-banner {
        font-size: 13px;
        color: #ef4444;
        margin-top: 8px;
        text-align: center;
      }

      .tooltip {
        display: inline-block;
        position: relative;
        width: 16px;
        height: 16px;
        margin-left: 8px;
        cursor: pointer;
        font-size: 12px;
        font-weight: 600;
        color: #fff;
        background: var(--brand);
        border-radius: 50%;
        text-align: center;
        line-height: 16px;
      }
      .tooltip:hover .tooltip-text {
        visibility: visible;
        opacity: 1;
      }
      .tooltip-text {
        visibility: hidden;
        opacity: 0;
        position: absolute;
        top: -10px;
        left: 24px;
        background: rgba(0, 0, 0, 0.9);
        color: #fff;
        font-size: 12px;
        padding: 8px;
        border-radius: 6px;
        width: 200px;
        z-index: 10;
        transition: opacity 0.2s ease;
      }
      .tooltip-text::before {
        content: '';
        position: absolute;
        top: 50%;
        right: 100%;
        margin-top: -5px;
        border: 5px solid transparent;
        border-right-color: rgba(0, 0, 0, 0.9);
      }

      .cta-button {
        width: 100%;
        padding: 20px;
        background: linear-gradient(135deg, var(--brand) 0%, var(--brand) 100%);
        color: #000;
        border: none;
        border-radius: 15px;
        font-size: 16px;
        font-weight: 800;
        text-transform: uppercase;
        letter-spacing: 1.5px;
        cursor: pointer;
        position: relative;
        overflow: hidden;
        transition: all 0.3s cubic-bezier(0.175, 0.885, 0.32, 1.275);
        opacity: 0;
        animation: buttonSlideUp 0.8s cubic-bezier(0.175, 0.885, 0.32, 1.275)
          1.4s forwards;
      
        background-color: #000;
        color: #fff;
      }
      @keyframes buttonSlideUp {
        from {
          opacity: 0;
          transform: translateY(50px) scale(0.9);
        }
        to {
          opacity: 1;
          transform: translateY(0) scale(1);
        }
      }
      .cta-button::before {
        content: "";
        position: absolute;
        top: 0;
        left: -100%;
        width: 100%;
        height: 100%;
        background: linear-gradient(
          90deg,
          transparent,
          rgba(255, 255, 255, 0.4),
          transparent
        );
        transition: left 0.5s ease;
      }
      .cta-button:hover::before {
        left: 100%;
      }
      .cta-button:hover {
        transform: translateY(-5px) scale(1.02);
        box-shadow: 0 20px 60px rgba(171, 255, 0, 0.5),
          inset 0 1px 0 rgba(255, 255, 255, 0.5);
      }

      .back-button {
        display: inline-flex;
        align-items: center;
        gap: 8px;
        padding: 10px 14px;
        border-radius: 10px;
        border: 1px solid rgba(0, 0, 0, 0.15);
        background: rgba(0, 0, 0, 0.04);
        color: #000;
        font-size: 14px;
        font-weight: 600;
        cursor: pointer;
        margin-bottom: 16px;
        transition: all 0.2s ease;
      }
      .back-button:hover {
        background: rgba(171, 255, 0, 0.15);
        border-color: var(--brand);
        color: var(--brand);
        transform: translateY(-1px);
      }

      .report-slider {
        background: rgba(0, 0, 0, 0.05);
        border-radius: 16px;
        padding: 30px;
        margin: 30px 0;
        height: 180px;
        display: flex;
        align-items: center;
        justify-content: center;
        position: relative;
        overflow: hidden;
        border: 9px solid rgba(0, 0, 0, 0);
      }
      .slide-content {
        text-align: center;
        color: #000;
        animation: slideIn 0.5s ease-out;
      }
      @keyframes slideIn {
        from {
          opacity: 0;
          transform: translateX(50px);
        }
        to {
          opacity: 1;
          transform: translateX(0);
        }
      }
      .slide-title {
        font-size: 22px;
        font-weight: 700;
        color: var(--brand);
        margin-bottom: 12px;
      }
      .slide-desc {
        font-size: 14px;
        line-height: 1.6;
        color: rgba(0, 0, 0, 0.7);
      }

      .footer-text {
        text-align: center;
        padding: 16px;
        margin: 20px 0;
        color: rgba(0, 0, 0, 0.6);
        font-size: 13px;
      }
      .footer-text strong {
        color: var(--brand);
      }

      .urgency-box {
        margin-top: 20px;
        text-align: center;
        opacity: 0;
        animation: urgencyPop 0.6s cubic-bezier(0.68, -0.55, 0.265, 1.55) 1.6s
          forwards;
      }
      @keyframes urgencyPop {
        from {
          opacity: 0;
          transform: scale(0);
        }
        to {
          opacity: 1;
          transform: scale(1);
        }
      }
      .urgency-content {
        display: inline-flex;
        align-items: center;
        gap: 10px;
        padding: 10px 20px;
        background: rgba(255, 255, 255, 0.1);
        border: 1px solid #000;
        border-radius: 100px;
        color: #000;
        font-size: 13px;
        font-weight: 600;
      }
      .live-indicator {
        width: 8px;
        height: 8px;
        background: #000;
        border-radius: 50%;
        box-shadow: 0 0 10px var(--brand);
        animation: livePulse 1.5s ease-in-out infinite;
      }
      @keyframes livePulse {
        0%,
        100% {
          transform: scale(1);
          box-shadow: 0 0 10px var(--brand);
        }
        50% {
          transform: scale(1.2);
          box-shadow: 0 0 20px var(--brand);
        }
      }

      .warning-box {
        background: rgba(239, 68, 68, 0.1);
        border: 1px solid rgba(239, 68, 68, 0.3);
        border-radius: 12px;
        padding: 16px;
        margin-bottom: 16px;
        color: rgba(0, 0, 0, 0.8);
        font-size: 13px;
        text-align: center;
      }

      .analysis-wrap {
        max-width: 520px;
        margin: 0 auto;
        text-align: center;
      }
      .analysis-title {
        font-size: 28px;
        font-weight: 900;
        margin: 18px 0 10px;
        color: #3b82f6;
      }
      .analyzing-url {
        font-size: 18px;
        color: #6b7280;
        margin-bottom: 20px;
      }
      .gt-browser-window {
        background: #fff;
        border-radius: 8px;
        box-shadow: 0 4px 20px rgba(0, 0, 0, 0.1);
        overflow: hidden;
        position: relative;
        max-width: 900px; /* Match screenshot width */
        width: 100%; /* Responsive */
        margin: 20px auto;
        border: 1px solid #e5e7eb;
      }
      .browser-header {
        background: #f3f4f6;
        padding: 8px 12px;
        display: flex;
        align-items: center;
        border-bottom: 1px solid #e5e7eb;
      }
      .browser-controls {
        display: flex;
        gap: 6px;
        margin-right: 12px;
      }
      .browser-dot {
        width: 12px;
        height: 12px;
        border-radius: 50%;
      }
      .browser-dot.red {
        background: #ef4444;
      }
      .browser-dot.yellow {
        background: #f59e0b;
      }
      .browser-dot.green {
        background: #10b981;
      }
      .browser-url-bar {
        flex: 1;
        background: #fff;
        border-radius: 4px;
        padding: 6px 10px;
        font-size: 12px;
        color: #374151;
        border: 1px solid #d1d5db;
        overflow: hidden;
        text-overflow: ellipsis;
        white-space: nowrap;
      }
      .browser-content {
        position: relative;
        background: #fff;
        overflow: hidden; /* For scan overlay */
      }
     
      #screenshot-container {
        width: 100%;
        max-height: 400px; /* Focus on hero section */
        overflow: auto; /* Enable scrolling if needed */
        display: block;
        background: white;
      }
      #screenshot {
        width: 100%; /* Fill container */
        max-width: 1200px; /* Increased for better resolution */
        height: auto; /* Maintain aspect ratio */
        display: block;
        object-fit: contain; /* Prevent distortion */
        image-rendering: -webkit-optimize-contrast;
        image-rendering: crisp-edges;
      }
      .analysis-meta {
        margin-top: 10px;
        display: flex;
        justify-content: center;
        gap: 10px;
        flex-wrap: wrap;
      }
      .meta-chip {
        font-size: 12px;
        font-weight: 700;
        color: #000;
        background: rgba(0, 0, 0, 0.05);
        border: 1px solid rgba(0, 0, 0, 0.08);
        padding: 6px 10px;
        border-radius: 999px;
      }
      .meta-chip strong {
        color: var(--brand);
      }
      .analysis-note {
        font-size: 12px;
        color: rgba(0, 0, 0, 0.55);
        margin-top: 6px;
      }

      .analysis-list {
        list-style: none;
        margin-top: 18px;
        display: grid;
        gap: 12px;
        position: relative;
        padding-left: 6px;
      }
      .analysis-list::before {
        content: "";
        position: absolute;
        left: 19px;
        top: 0;
        bottom: 0;
        width: 2px;
        background: linear-gradient(var(--brand), var(--brand2));
        opacity: 0.25;
        border-radius: 2px;
      }
      .analysis-item {
        position: relative;
        display: flex;
        align-items: center;
        gap: 12px;
        padding: 12px 14px;
        border-radius: 12px;
        background: #fff;
        border: 1px solid rgba(0, 0, 0, 0.06);
      }
      .status-icon {
        flex: 0 0 18px;
        width: 18px;
        height: 18px;
        border-radius: 50%;
        border: 2px solid #cbd5e1;
        position: relative;
        display: grid;
        place-items: center;
        color: #fff;
        font-size: 12px;
        font-weight: 800;
        background: #fff;
        z-index: 1;
      }
      .analysis-item.pending {
        opacity: 0.55;
      }
      .analysis-item.active {
        background: rgba(76, 175, 80, 0.08);
        border: 1px solid rgba(76, 175, 80, 0.25);
        box-shadow: 0 4px 16px rgba(171, 255, 0, 0.12);
      }
      .analysis-item.active .status-icon {
        border-color: var(--brand);
      }
      .analysis-item.active .status-icon::after {
        content: "";
        width: 8px;
        height: 8px;
        background: var(--brand);
        border-radius: 50%;
        position: absolute;
        top: 50%;
        left: 50%;
        transform: translate(-50%, -50%);
      }
      .analysis-item.done .status-icon {
        background: var(--brand);
        border-color: var(--brand);
      }
      .analysis-item.done .status-icon::after {
        content: "✓";
        font-size: 12px;
        color: #fff;
        transform: none;
        width: auto;
        height: auto;
        background: transparent;
      }
      .analysis-item.done .analysis-text {
        color: var(--brand);
        font-weight: 700;
      }
      .analysis-text {
        text-align: left;
        color: var(--text);
        font-weight: 600;
        font-size: 14px;
      }

      .results-card {
        background: rgba(171, 255, 0, 0.05);
        border: 1px solid rgb(0, 0, 0);
        border-radius: 16px;
        padding: 24px;
        margin-bottom: 24px;
        color: #000;
      }
      .metric-grid {
        display: grid;
        grid-template-columns: 1fr 1fr;
        gap: 20px;
        margin-bottom: 30px;
      }
      .metric-box {
        text-align: center;
      }
      .metric-value {
        font-size: 32px;
        font-weight: 900;
        color: var(--brand);
      }
      .metric-label {
        font-size: 12px;
        color: rgba(0, 0, 0, 0.6);
        text-transform: uppercase;
        margin-top: 8px;
      }
      .issue-item {
        background: rgba(0, 0, 0, 0.03);
        border-left: 3px solid var(--brand);
        padding: 16px;
        margin-bottom: 12px;
        border-radius: 8px;
        color: rgba(0, 0, 0, 0.8);
        user-select: none;
      }
      .priority-high {
        border-left-color: #ef4444;
      }
      .priority-medium {
        border-left-color: #f59e0b;
      }
      .priority-low {
        border-left-color: #10b981;
      }
      .competitor-item {
        display: flex;
        justify-content: space-between;
        padding: 12px;
        background: rgba(0, 0, 0, 0.03);
        border-radius: 8px;
        margin-bottom: 12px;
        color: rgba(0, 0, 0, 0.8);
      }
.scan-overlay {
  position: absolute;
  top: 0;
  left: 0;
  width: 100%;
  height: 100%;
  background: linear-gradient(
    90deg,
    transparent 0%,
    rgba(76, 175, 80, 0.3) 50%, /* Slightly more opaque for visibility */
    transparent 100%
  );
  transform: translateX(-100%);
  animation: scan 2s linear infinite;
  z-index: 1;
}
@keyframes scan {
  0% {
    transform: translateX(-100%);
  }
  100% {
    transform: translateX(100%);
  }
}
      .score-grid {
        display: grid;
        grid-template-columns: repeat(2, 1fr);
        gap: 16px;
        margin-top: 20px;
      }
      .score-item {
        background: rgba(0, 0, 0, 0.05);
        border-radius: 12px;
        padding: 16px;
        text-align: center;
      }
      .score-value {
        font-size: 24px;
        font-weight: 700;
        color: var(--brand);
      }
      .score-label {
        font-size: 12px;
        color: rgba(0, 0, 0, 0.6);
        margin-top: 4px;
      }
      .results-image {
        width: 100%;
        max-width: 500px;
        height: auto;
        border-radius: 16px;
        margin: 20px auto;
        display: block;
        box-shadow: 0 4px 20px rgba(0, 0, 0, 0.1);
      }

      .calendly-container {
        margin-top: 20px;
        border-radius: 16px;
        overflow: hidden;
        box-shadow: 0 4px 20px rgba(0, 0, 0, 0.1);
      }

      .kodexo-logo {
        display: block;
        margin: 20px auto;
        max-width: 200px;
        height: auto;
      }

      .calculation-table {
        width: 100%;
        border-collapse: collapse;
        margin: 20px 0;
        font-size: 14px;
        background: rgba(0, 0, 0, 0.03);
        border-radius: 8px;
        overflow: hidden;
      }
      .calculation-table th,
      .calculation-table td {
        padding: 12px;
        text-align: left;
        border-bottom: 1px solid rgba(0, 0, 0, 0.1);
      }
      .calculation-table th {
        background: rgba(0, 0, 0, 0.05);
        font-weight: 700;
        color: var(--brand);
      }
      .calculation-table td {
        color: rgba(0, 0, 0, 0.8);
      }
      .calculation-table tr:last-child td {
        border-bottom: none;
      }

      .sr-only {
        position: absolute;
        width: 1px;
        height: 1px;
        padding: 0;
        margin: -1px;
        overflow: hidden;
        clip: rect(0, 0, 0, 0);
        white-space: nowrap;
        border: 0;
      }

      #step7-screenshot {
        width: 100%;
        max-width: 1200px;
        height: auto;
        display: block;
        object-fit: contain;
        image-rendering: -webkit-optimize-contrast;
        image-rendering: crisp-edges;
      }

      @media (max-width: 640px) {
        .form-card {
          padding: 30px 20px;
        }
        h1 {
          font-size: 28px;
        }
        .text-green {
          font-size: 32px;
        }
        h2 {
          font-size: 24px;
        }
        .description {
          font-size: 14px;
          max-width: 100%;
        }
        .challenge-grid {
          grid-template-columns: 1fr;
        }
        .metric-grid {
          grid-template-columns: 1fr;
        }
        .score-grid {
          grid-template-columns: 1fr;
        }
        .report-slider {
          height: 150px;
          padding: 20px;
        }
        .slide-title {
          font-size: 18px;
        }
        .slide-desc {
          font-size: 12px;
        }
        .form-group {
          margin-bottom: 12px;
        }
        input[type="text"],
        input[type="number"],
        input[type="email"],
        input[type="url"],
        input[type="tel"],
        select {
          padding: 12px;
          font-size: 14px;
        }
        .cta-button {
          padding: 16px;
          font-size: 14px;
        }
        .back-button {
          padding: 8px 12px;
          font-size: 12px;
        }
        .analysis-title {
          font-size: 24px;
        }
        .analyzing-url {
          font-size: 16px;
        }
        .gt-browser-window {
          height: 350px;
          max-width: 100%;
        }
        .browser-content {
          height: 316px;
        }
        #screenshot-container {
          max-height: 316px;
        }
        #screenshot {
          max-width: 100%;
        }
        .browser-url-bar {
          font-size: 10px;
        }
        .container {
          padding: 10px;
        }
        .shape-1,
        .shape-2,
        .shape-3 {
          display: none;
        }
        .neon-line-1,
        .neon-line-2 {
          display: none;
        }
        .tooltip-text {
          width: 150px;
          font-size: 11px;
          left: 20px;
          top: -20px;
        }
      }
    </style>
  </head>
  <body>
    <div class="transition-overlay" id="transitionOverlay">
      <div class="liquid-transition">
        <div class="liquid-circle" id="liquidCircle"></div>
      </div>
    
    </div>

    <div class="grid-bg"></div>
    <div class="shape shape-1"></div>
    <div class="shape shape-2"></div>
    <div class="shape shape-3"></div>
    <div class="neon-line neon-line-1"></div>
    <div class="neon-line neon-line-2"></div>

    <div class="container">
      <div class="form-card" id="formCard">
        <div
          class="progress-container"
          id="progressContainer"
          style="display: none"
        >
          <div class="progress-step" data-step="1"></div>
          <div class="progress-step" data-step="2"></div>
          <div class="progress-step" data-step="3"></div>
          <div class="progress-step" data-step="4"></div>
        </div>

        <div class="top-progress" id="topProgress">
          <div class="progress-header">
            <span
              >Step <span id="currentStepText">1</span> of
              <span id="totalStepsText">7</span></span
            >
            <span id="progressPercent">0%</span>
          </div>
          <div class="progress-bar">
            <div class="progress-fill" id="progressFill"></div>
          </div>
        </div>

        <div class="step active" id="step1">
          <div class="brand-tagline">
            FOR SHOPIFY BRANDS DOING OVER $50K A MONTH
          </div>
          <h1>
            <span class="text-white">FREE AI-GENERATED</span
            ><span class="text-green">CONVERSION REPORT</span>
          </h1>
          <p class="description">
            Claim your AI Conversion Report mapping all growth opportunities on
            your Shopify Store with exclusive focus on how you can convert your
            traffic into dollars.
          </p>
          <button class="cta-button">Start Free Audit Now →</button>
          <div class="urgency-box">
            <div class="urgency-content">
              <div class="live-indicator"></div>
              <span>Only 7 free audits remaining today</span>
            </div>
          </div>
          <div class="report-slider">
            <div class="slide-content" id="slideContent"></div>
          </div>
        </div>

        <div class="step" id="step2">
          <h2>What's Your Biggest Issue?</h2>
          <div class="challenge-grid" id="challengeGrid">
            <div
              class="challenge-card"
              onclick="selectChallenge(this,'low-conversion')"
            >
              Low conversion rate
            </div>
            <div
              class="challenge-card"
              onclick="selectChallenge(this,'low-aov')"
            >
              Low Average Order Value
            </div>
            <div
              class="challenge-card"
              onclick="selectChallenge(this,'low-subscription')"
            >
              Low Subscription rate
            </div>
          </div>
          <div class="error-banner" id="challengeError" style="display: none">
            Please select a challenge to continue.
          </div>
          <div class="footer-text">
            <strong>We've audited +1,000 Shopify Stores</strong> using AI.
          </div>
          <button class="cta-button">Continue →</button>
        </div>

        <div class="step" id="step3">
          <h2>Let's get started with your numbers!</h2>
          <div class="form-group">
            <label>
              Monthly revenue ($)
              <span class="tooltip">?
                <span class="tooltip-text">Your store's total revenue per month from all sales channels.</span>
              </span>
            </label>
            <input
              type="text"
              id="monthlyRevenue"
              placeholder="$ Total revenue per month"
              required
            />
            <div
              class="error-text"
              id="err-monthlyRevenue"
              style="display: none"
            ></div>
          </div>
          <div class="form-group">
            <label>
              Monthly ad spend ($)
              <span class="tooltip">?
                <span class="tooltip-text">Total amount spent on advertising across all channels (e.g., Google Ads, Facebook Ads).</span>
              </span>
            </label>
            <input
              type="text"
              id="monthlyAdSpend"
              placeholder="$ Total ad spend on all channels"
              required
            />
            <div
              class="error-text"
              id="err-monthlyAdSpend"
              style="display: none"
            ></div>
          </div>
          <div class="footer-text" style="color: #f59e0b">
            The audit will not work if you do not submit real numbers.
          </div>
          <button class="cta-button">Continue →</button>
        </div>

        <div class="step" id="step4">
          <h2>Perfect! Now add your Shopify metrics</h2>
          <div class="form-group">
            <label>
              Conversion rate (%)
              <span class="tooltip">?
                <span class="tooltip-text">Percentage of website visitors who complete a purchase (e.g., 2% means 2 out of 100 visitors buy).</span>
              </span>
            </label>
            <input
              type="number"
              id="conversionRate"
              step="0.01"
              placeholder="Percentage of visitors who make a purchase"
              required
              min="0"
              max="100"
            />
            <div
              class="error-text"
              id="err-conversionRate"
              style="display: none"
            ></div>
          </div>
          <div class="form-group">
            <label>
              Average order value ($)
              <span class="tooltip">?
                <span class="tooltip-text">Average dollar amount per order, calculated as total revenue divided by number of orders.</span>
              </span>
            </label>
            <input
              type="number"
              id="aov"
              placeholder="Average $ amount per order"
              required
              min="0.01"
              step="any"
            />
            <div class="error-text" id="err-aov" style="display: none"></div>
          </div>
          <div class="form-group">
           <label>
  Subscription rate (%) <span style="color: #888; font-weight: normal;">(Optional)</span>
  <span class="tooltip">?
    <span class="tooltip-text">
      Percentage of customers who opt for a subscription plan, if applicable to your store.
    </span>
  </span>
</label>
            <input
              type="number"
              id="subscriptionRate"
              step="0.01"
              placeholder="For subscription brands"
              min="0"
              max="100"
            />
            <div
              class="error-text"
              id="err-subscriptionRate"
              style="display: none"
            ></div>
          </div>
          <div class="footer-text">
            <strong>We've audited +1,000 Shopify Stores</strong> using AI.
          </div>
          <button class="cta-button">Continue →</button>
        </div>

        <div class="step" id="step5">
          <h2>Let's fix that! You're almost done.</h2>
          <p class="description">
            Add a valuable URL (best-selling product page) for the most valuable
            insights.
          </p>
          <div class="warning-box">
            ⚠️ Audit will not work if fake numbers are used.
          </div>
          <div class="form-group">
            <label>Website URL</label>
            <input
              type="url"
              id="websiteUrl"
              placeholder="https://www.yourstore.com"
              required
            />
            <div
              class="error-text"
              id="err-websiteUrl"
              style="display: none"
            ></div>
          </div>
          <div class="form-group">
            <label>Type of page</label>
            <select id="pageType" required>
              <option value="">Select page type</option>
              <option value="Home">Home Page</option>
              <option value="Landing Page">Landing Page</option>
              <option value="collection">Collection page</option>
              <option value="product">Product page</option>
              <option value="other">Other</option>
            </select>
            <div
              class="error-text"
              id="err-pageType"
              style="display: none"
            ></div>
          </div>
          <div class="form-group">
            <label>Industry</label>
            <select id="industry" required>
              <option value="">Select Industry</option>
              <option value="fashion">Fashion & Apparel</option>
              <option value="health">Health & Beauty</option>
              <option value="home">Home & Garden</option>
              <option value="electronics">Electronics</option>
              <option value="food">Food & Beverage</option>
              <option value="jewelry">Jewelry & Accessories</option>
              <option value="sports">Sports & Recreation</option>
              <option value="other">Other</option>
            </select>
            <div
              class="error-text"
              id="err-industry"
              style="display: none"
            ></div>
          </div>
          <div class="footer-text">
            That way the AI is better at analyzing it.
          </div>
          <button class="cta-button">Generate My AI Report →</button>
        </div>

    <div class="step" id="step6">
  <div class="analysis-wrap">
    <h3 class="analysis-title">Analyzing your URL...</h3>
    <p class="analyzing-url" id="analyzing-url">https://www.yourstore.com</p>
    <div class="gt-browser-window">
      <div class="browser-header">
        <div class="browser-controls">
          <span class="browser-dot red"></span>
          <span class="browser-dot yellow"></span>
          <span class="browser-dot green"></span>
        </div>
        <div class="browser-url-bar">
          <span id="browser-url">https://www.yourstore.com</span>
        </div>
      </div>
      <div class="browser-content">
        <div class="scan-overlay"></div> <!-- Add the scan overlay here -->
        <div id="screenshot-container">
          <img id="screenshot" alt="Website Hero Section Screenshot" src="https://via.placeholder.com/900x400?text=Loading+Screenshot">
        </div>
      </div>
    </div>
    <div class="analysis-meta">
      <div class="meta-chip">
        Est. time left: <strong id="timeLeft">—</strong>
      </div>
      <div class="meta-chip">Live tasks updating</div>
    </div>
    <p class="analysis-note">This typically takes 10–20 seconds.</p>
    <ul class="analysis-list" id="analysisList"></ul>
    <div id="ariaLive" class="sr-only" aria-live="polite"></div>
  </div>
</div>
        <div class="step" id="step7">
          <h2>AI Conversion Report is completed!</h2>
          <p class="description">
            AI has detected <strong>21 improvements</strong> on
            <span id="userDomain">yourstore.com</span>
          </p>
          <img id="step7-screenshot" src="https://staging.kodexolabs.com/wp-content/uploads/2025/09/website.png" alt="Website Preview" class="results-image">
          <div class="results-card">
            <h3 style="color: black; margin-bottom: 20px">
              Estimated Potential Revenue Uplift
            </h3>
            <p class="description" id="upliftCalculation" style="text-align: left;">
              Based on your industry and current conversion rate, here's the potential revenue uplift:
            </p>
            <table class="calculation-table">
              <tr>
                <th>Metric</th>
                <th>Value</th>
              </tr>
              <tr>
                <td>Your Current Conversion Rate</td>
                <td id="currentConversionRate"></td>
              </tr>
              <tr>
                <td>Industry Benchmark Conversion Rate</td>
                <td id="benchmarkConversionRate"></td>
              </tr>
              <tr>
                <td>Potential Conversion Rate Uplift</td>
                <td id="conversionRateUplift"></td>
              </tr>
              <tr>
                <td>Estimated Monthly Revenue Uplift</td>
                <td id="revenuePotential"></td>
              </tr>
              <tr>
                <td>Cost of Inaction (Per Month)</td>
                <td id="costInaction"></td>
              </tr>
            </table>
          </div>
          <div class="results-card">
            <h3 style="color: black; margin-bottom: 20px">
              Critical Issues Found <br> These issues are partly the reason why your <span id="mainMetric"></span> is low.
            </h3>
            <div class="issue-item priority-high">
              🔴 A total of 6 High priority issues were found
            </div>
            <div class="issue-item priority-medium">
              🟡 A total of 9 medium priority issues were found
            </div>
            <div class="issue-item priority-low">
              🟢 A total of 6 quick wins were found
            </div>
          </div>
          <div class="results-card">
            <h3 style="color: var(--brand); margin-bottom: 20px">
              Performance Scorecards
            </h3>
            <div class="score-grid">
              <div class="score-item">
                <div class="score-value">32/100</div>
                <div class="score-label">
                  Site Performance (Desktop: 32 | Mobile: 28)
                </div>
              </div>
              <div class="score-item">
                <div class="score-value">23</div>
                <div class="score-label">Mobile Usability Issues</div>
              </div>
              <div class="score-item">
                <div class="score-value">45/100</div>
                <div class="score-label">Technical SEO</div>
              </div>
              <div class="score-item">
                <div class="score-value">62/100</div>
                <div class="score-label">UX Score</div>
              </div>
            </div>
          </div>

          <h3 style="color: var(--brand); text-align: center; margin: 30px 0">
            Want to see the full report and all the issues uncovered?
          </h3>

          <!-- New: Lead capture fields above the CTA -->
          <div class="results-card" id="leadCaptureCard">
            <h3 style="color: var(--brand); margin-bottom: 12px">Your details</h3>

            <div class="form-group">
              <label for="userName">Name</label>
              <input type="text" id="userName" placeholder="Your full name" required />
              <div class="error-text" id="err-userName" style="display: none"></div>
            </div>

            <div class="form-group">
              <label for="userEmail">Email</label>
              <input type="email" id="userEmail" placeholder="you@company.com" required />
              <div class="error-text" id="err-userEmail" style="display: none"></div>
            </div>

            <div class="form-group">
              <label for="userPhone">Phone number</label>
              <input type="tel" id="userPhone" inputmode="tel" placeholder="+1 555 123 4567" required />
              <div class="error-text" id="err-userPhone" style="display: none"></div>
            </div>
          </div>

          <button class="cta-button">Book Your Free Strategy Call →</button>
        </div>
      </div>
    </div>

    <script>
      let currentStep = 1;
const totalSteps = 7;
const steps = document.querySelectorAll(".step");
const progressSteps = document.querySelectorAll(".progress-step");
const progressContainer = document.getElementById("progressContainer");

const topProgressEl = document.getElementById("topProgress");
const currentStepText = document.getElementById("currentStepText");
const totalStepsText = document.getElementById("totalStepsText");
const progressFillEl = document.getElementById("progressFill");
const progressPercentEl = document.getElementById("progressPercent");
if (totalStepsText) totalStepsText.textContent = totalSteps;

const analysis = {
  rafId: null,
  timeouts: [],
  startTime: 0,
  totalDuration: 0,
  running: false,
  countdownId: null,
};

// Industry benchmark conversion rates
const benchmarkConversionRates = {
  fashion: 2.5,
  health: 3.0,
  home: 2.8,
  electronics: 2.0,
  food: 2.7,
  jewelry: 2.3,
  sports: 2.4,
  other: 2.5
};

// Store form data
let formData = {
  challenge: '',
  monthlyRevenue: 0,
  monthlyAdSpend: 0,
  conversionRate: 0,
  aov: 0,
  subscriptionRate: 0,
  websiteUrl: '',
  pageType: '',
  industry: '',
  name: '',
  email: '',
  phone: ''
};

function formatCurrency(inputEl) {
  let value = inputEl.value.replace(/[^0-9.]/g, '');
  if (value === '' || isNaN(parseFloat(value))) {
    inputEl.value = '';
    return;
  }
  const num = parseFloat(value);
  inputEl.value = '$' + num.toLocaleString('en-US', { minimumFractionDigits: 2, maximumFractionDigits: 2 });
}

function parseCurrency(value) {
  return parseFloat(value.replace(/[^0-9.]/g, '')) || 0;
}

// Apply currency formatting to Step 3 inputs
// Apply currency formatting to Step 3 inputs
['monthlyRevenue', 'monthlyAdSpend'].forEach(id => {
  const input = document.getElementById(id);
  
  // Format currency on input
  input.addEventListener('input', () => {
    clearFieldError(input);
    // Allow user to type without immediate formatting to avoid cursor issues
  });

  // Format currency on blur (when user leaves the input field)
  input.addEventListener('blur', () => {
    if (input.value.trim() === '') return; // Skip if empty
    formatCurrency(input);
  });

  // Optional: Format after a short delay to catch completed input
  let typingTimer;
  input.addEventListener('input', () => {
    clearTimeout(typingTimer);
    typingTimer = setTimeout(() => {
      if (input.value.trim() !== '') {
        formatCurrency(input);
      }
    }, 1000); // 1-second delay to assume user has finished typing
  });
});

// Updated formatCurrency function
function formatCurrency(inputEl) {
  let value = inputEl.value.replace(/[^0-9.]/g, ''); // Remove non-numeric characters except decimal
  if (value === '' || isNaN(parseFloat(value))) {
    inputEl.value = ''; // Clear if invalid
    return;
  }
  const num = parseFloat(value);
  // Format with $ and ensure 2 decimal places
  inputEl.value = '$' + num.toLocaleString('en-US', { minimumFractionDigits: 2, maximumFractionDigits: 2 });
}
function cancelAnalysis() {
  if (analysis.rafId) cancelAnimationFrame(analysis.rafId);
  analysis.timeouts.forEach((t) => clearTimeout(t));
  analysis.timeouts = [];
  if (analysis.countdownId) clearInterval(analysis.countdownId);
  analysis.running = false;
}

function showStep(stepNumber) {
  steps.forEach((s) => s.classList.remove("active"));
  const active = document.getElementById(`step${stepNumber}`);
  if (active) active.classList.add("active");

  progressContainer.style.display =
    stepNumber >= 2 && stepNumber <= 5 ? "flex" : "none";

  progressSteps.forEach((p, i) => {
    const idx = i + 2;
    p.classList.remove("active", "completed");
    if (stepNumber > idx) p.classList.add("completed");
    else if (stepNumber === idx) p.classList.add("active");
  });

  topProgressEl.style.display = "block";
  currentStepText.textContent = Math.min(stepNumber, totalSteps);
  const percent = Math.round(((stepNumber - 1) / (totalSteps - 1)) * 100);
  progressFillEl.style.width = percent + "%";
  progressPercentEl.textContent = percent + "%";
}

function nextStep() {
  if (currentStep < totalSteps) {
    currentStep++;
    showStep(currentStep);
  }
}
function previousStep() {
  cancelAnalysis();
  if (currentStep > 1) {
    currentStep--;
    showStep(currentStep);
  }
}

function selectChallenge(el, value) {
  document
    .querySelectorAll(".challenge-card")
    .forEach((c) => c.classList.remove("selected"));
  el.classList.add("selected");
  formData.challenge = value;
}

function showFieldError(inputEl, msg) {
  if (!inputEl) return;
  inputEl.classList.add("input-error");
  const err = document.getElementById("err-" + inputEl.id);
  if (err) {
    err.textContent = msg;
    err.style.display = "block";
  }
}
function clearFieldError(inputEl) {
  if (!inputEl) return;
  inputEl.classList.remove("input-error");
  const err = document.getElementById("err-" + inputEl.id);
  if (err) {
    err.textContent = "";
    err.style.display = "none";
  }
}
document.querySelectorAll("input,select").forEach((el) => {
  el.addEventListener("input", () => clearFieldError(el));
  el.addEventListener("change", () => clearFieldError(el));
});

function validateStep(stepId) {
  if (stepId === "step1") return true;
  if (stepId === "step2") {
    const selected = document.querySelector(".challenge-card.selected");
    const err = document.getElementById("challengeError");
    if (!selected) {
      err.style.display = "block";
      return false;
    }
    err.style.display = "none";
    return true;
  }
  if (stepId === "step3") {
    let valid = true;
    const rev = document.getElementById("monthlyRevenue");
    const ad = document.getElementById("monthlyAdSpend");
    const revVal = parseCurrency(rev.value);
    const adVal = parseCurrency(ad.value);
    formData.monthlyRevenue = revVal;
    formData.monthlyAdSpend = adVal;
    if (!(revVal >= 0)) {
      showFieldError(rev, "Please enter a valid monthly revenue (>= 0).");
      valid = false;
    }
    if (!(adVal >= 0)) {
      showFieldError(ad, "Please enter a valid monthly ad spend (>= 0).");
      valid = false;
    }
    return valid;
  }
  if (stepId === "step4") {
    let valid = true;
    const cr = document.getElementById("conversionRate");
    const aov = document.getElementById("aov");
    const sub = document.getElementById("subscriptionRate");
    const crVal = parseFloat(cr.value) || 0;
    const aovVal = parseFloat(aov.value) || 0;
    const subVal = parseFloat(sub.value) || 0;
    formData.conversionRate = crVal;
    formData.aov = aovVal;
    formData.subscriptionRate = subVal;
    if (!(crVal >= 0 && crVal <= 100)) {
      showFieldError(
        cr,
        "Enter a valid conversion rate between 0 and 100."
      );
      valid = false;
    }
    if (!(aovVal > 0)) {
      showFieldError(aov, "Enter a valid AOV (> 0).");
      valid = false;
    }
    if (subVal < 0 || subVal > 100) {
      showFieldError(
        sub,
        "Enter a valid subscription rate between 0 and 100, or leave blank."
      );
      valid = false;
    }
    return valid;
  }
  if (stepId === "step5") {
    let valid = true;
    const urlEl = document.getElementById("websiteUrl");
    const pageTypeEl = document.getElementById("pageType");
    const industryEl = document.getElementById("industry");
    formData.websiteUrl = urlEl.value;
    formData.pageType = pageTypeEl.value;
    formData.industry = industryEl.value;
    let okUrl = true;
    try {
      const u = new URL(urlEl.value);
      if (!/^https?:$/.test(u.protocol)) okUrl = false;
      if (!u.hostname.includes(".")) okUrl = false;
    } catch (e) {
      okUrl = false;
    }
    if (!okUrl) {
      showFieldError(urlEl, "Please enter a valid URL[](https://...)");
      valid = false;
    }
    if (!pageTypeEl.value) {
      pageTypeEl.classList.add("input-error");
      const e1 = document.getElementById("err-pageType");
      e1.textContent = "Please select a page type.";
      e1.style.display = "block";
      valid = false;
    }
    if (!industryEl.value) {
      industryEl.classList.add("input-error");
      const e2 = document.getElementById("err-industry");
      e2.textContent = "Please select an industry.";
      e2.style.display = "block";
      valid = false;
    }
    pageTypeEl.addEventListener("change", () => {
      pageTypeEl.classList.remove("input-error");
      document.getElementById("err-pageType").style.display = "none";
    });
    industryEl.addEventListener("change", () => {
      industryEl.classList.remove("input-error");
      document.getElementById("err-industry").style.display = "none";
    });
    return valid;
  }
  return true;
}

// Validate name, email, phone on Step 7
function validateLeadForm() {
  const nameEl = document.getElementById('userName');
  const emailEl = document.getElementById('userEmail');
  const phoneEl = document.getElementById('userPhone');

  [nameEl, emailEl, phoneEl].forEach(clearFieldError);

  let valid = true;

  const nameVal = nameEl.value.trim();
  if (!nameVal) {
    showFieldError(nameEl, 'Please enter your name.');
    valid = false;
  }

  const emailVal = emailEl.value.trim();
  const emailOk = /^[^\s@]+@[^\s@]+\.[^\s@]+$/.test(emailVal);
  if (!emailOk) {
    showFieldError(emailEl, 'Enter a valid email address.');
    valid = false;
  }

  const phoneVal = phoneEl.value.trim();
  const phoneDigits = phoneVal.replace(/\D/g, '');
  if (phoneDigits.length < 7) {
    showFieldError(phoneEl, 'Enter a valid phone number.');
    valid = false;
  }

  if (valid) {
    formData.name = nameVal;
    formData.email = emailVal;
    formData.phone = phoneVal;
  }
  return valid;
}

const analysisItems = [
  "Crawling your website structure",
  "Analyzing copy related issue",
  "Scanning for UX related issues bugs",
  "Conducting full CRO Audit benchmarking",
];

function buildAnalysisList() {
  const list = document.getElementById("analysisList");
  list.innerHTML = "";
  analysisItems.forEach((txt, i) => {
    const li = document.createElement("li");
    li.className = "analysis-item " + (i === 0 ? "active" : "pending");
    li.innerHTML = `<span class="status-icon"></span><span class="analysis-text">${txt}</span>`;
    list.appendChild(li);
  });
}

function setAnalysisState(stepIndex) {
  const items = document.querySelectorAll("#analysisList .analysis-item");
  const aria = document.getElementById("ariaLive");
  items.forEach((li, i) => {
    li.classList.remove("pending", "active", "done");
    if (i < stepIndex) li.classList.add("done");
    else if (i === stepIndex) li.classList.add("active");
    else li.classList.add("pending");
  });
  const activeItem = items[stepIndex];
  if (activeItem && aria) {
    aria.textContent =
      "Now: " + activeItem.querySelector(".analysis-text").textContent;
  }
}

function calculateUplift() {
  const industry = formData.industry || 'other';
  const benchmarkRate = benchmarkConversionRates[industry] || 2.5;
  const currentRate = formData.conversionRate || 0;
  const monthlyRevenue = formData.monthlyRevenue || 0;
  const aov = formData.aov || 0;

  // Calculate number of monthly visitors
  const monthlyOrders = monthlyRevenue / aov;
  const monthlyVisitors = monthlyOrders / (currentRate / 100);

  // Calculate potential uplift
  let upliftRate = 0;
  if (currentRate < benchmarkRate) {
    upliftRate = benchmarkRate - currentRate;
  }
  const potentialOrders = monthlyVisitors * (upliftRate / 100);
  const revenueUplift = potentialOrders * aov;
  const costOfInaction = revenueUplift / 6; // Assuming 6 months to achieve full potential

  // Update Step 7 display
  document.getElementById('currentConversionRate').textContent = currentRate.toFixed(2) + '%';
  document.getElementById('benchmarkConversionRate').textContent = benchmarkRate.toFixed(2) + '%';
  document.getElementById('conversionRateUplift').textContent = upliftRate.toFixed(2) + '%';
  document.getElementById('revenuePotential').textContent = '$' + revenueUplift.toLocaleString('en-US', { minimumFractionDigits: 0, maximumFractionDigits: 0 });
  document.getElementById('costInaction').textContent = '$' + costOfInaction.toLocaleString('en-US', { minimumFractionDigits: 0, maximumFractionDigits: 0 });
  document.getElementById('mainMetric').textContent = formData.challenge === 'low-conversion' ? 'Conversion Rate' : formData.challenge === 'low-aov' ? 'Average Order Value' : 'Subscription Rate';
}

function startAnalysis() {
  cancelAnalysis();
  currentStep = 6;
  showStep(currentStep);
  buildAnalysisList();

  const websiteUrl = document.getElementById("websiteUrl")?.value || "https://www.yourstore.com";
  document.getElementById("analyzing-url").textContent = websiteUrl;
  document.getElementById("browser-url").textContent = websiteUrl;

  let domain = "yourstore.com";
  try {
    domain = new URL(websiteUrl).hostname;
  } catch (e) {
    console.error("Invalid URL:", websiteUrl);
  }
  document.getElementById("userDomain").textContent = domain;

  // Load high-resolution screenshot of hero section
  const screenshotUrl = `https://image.thum.io/get/width/1200/crop/600/noanimate/wait/2/${websiteUrl}`;
  const screenshotImg = document.getElementById("screenshot");
  const step7ScreenshotImg = document.getElementById("step7-screenshot");
  
  // Load screenshot directly
  screenshotImg.src = screenshotUrl;
  step7ScreenshotImg.src = screenshotUrl;

  // Debug image loading
  screenshotImg.onload = () => {
    console.log("Screenshot loaded successfully:", screenshotUrl);
  };
  screenshotImg.onerror = () => {
    console.error("Failed to load screenshot:", screenshotUrl);
    screenshotImg.src = "https://via.placeholder.com/900x400?text=Screenshot+Unavailable";
    step7ScreenshotImg.src = "https://via.placeholder.com/900x400?text=Screenshot+Unavailable";
  };

  const minMs = 10000,
    maxMs = 20000;
  const totalMs = Math.floor(minMs + Math.random() * (maxMs - minMs));
  analysis.running = true;

  const stepsCount = analysisItems.length;
  const weights = Array.from(
    { length: stepsCount },
    () => 0.8 + Math.random() * 1.2
  );
  const wSum = weights.reduce((a, b) => a + b, 0);
  const durations = weights.map((w) => Math.round((w / wSum) * totalMs));
  const sumExceptLast = durations.slice(0, -1).reduce((a, b) => a + b, 0);
  durations[durations.length - 1] = totalMs - sumExceptLast;

  let acc = 0;
  for (let i = 0; i < stepsCount; i++) {
    analysis.timeouts.push(setTimeout(() => setAnalysisState(i), acc));
    acc += durations[i];
  }
  analysis.timeouts.push(
    setTimeout(() => {
      if (!analysis.running) return;
      analysis.running = false;
      currentStep = 7;
      calculateUplift();
      showStep(currentStep);
    }, totalMs + 120)
  );

  const timeLeft = document.getElementById("timeLeft");
  let remainingMs = totalMs;
  timeLeft.textContent = (remainingMs / 1000).toFixed(1) + "s";
  analysis.countdownId = setInterval(() => {
    remainingMs -= 100;
    if (remainingMs <= 0) {
      timeLeft.textContent = "0s";
      clearInterval(analysis.countdownId);
      return;
    }
    timeLeft.textContent =
      (Math.ceil(remainingMs / 100) / 10).toFixed(1).replace(/\.0$/, "") + "s";
  }, 100);
}
// Calendly loader with prefill support
function loadCalendlyWidget(prefill = {}) {
  const step7 = document.getElementById("step7");
  step7.innerHTML = ""; // Replace Step 7 with Calendly embed
  step7.classList.remove("no-scroll");

  // Add the text above the Calendly widget
  const textElement = document.createElement("h2");
  textElement.textContent = "Book a quick 20 minute call with us get a walkthrough on how to fix all your issues";
  textElement.style.textAlign = "center";
  textElement.style.marginBottom = "20px";
  step7.appendChild(textElement);

  const calendlyContainer = document.createElement("div");
  calendlyContainer.className = "calendly-container";
  calendlyContainer.style.marginTop = "20px";

  const calendlyDiv = document.createElement("div");
  calendlyDiv.id = "calendlyInlineContainer";
  calendlyDiv.style.minWidth = "320px";
  calendlyDiv.style.height = "700px";

  calendlyContainer.appendChild(calendlyDiv);
  step7.appendChild(calendlyContainer);

  const calendlyUrl = "https://calendly.com/d/cv3b-wzr-hvc/purplefire-s-cro-audit-strategy-call?hide_gdpr_banner=1";

  function initWidget() {
    if (window.Calendly && typeof window.Calendly.initInlineWidget === "function") {
      window.Calendly.initInlineWidget({
        url: calendlyUrl,
        parentElement: calendlyDiv,
        prefill: {
          name: prefill.name || "",
          email: prefill.email || "",
          customAnswers: {
            a1: prefill.phone || ""
          }
        }
      });
    }
  }

  // Load Calendly script if not present, then init
  if (!document.querySelector('script[src="https://assets.calendly.com/assets/external/widget.js"]')) {
    const script = document.createElement("script");
    script.type = "text/javascript";
    script.src = "https://assets.calendly.com/assets/external/widget.js";
    script.async = true;
    script.onload = initWidget;
    document.body.appendChild(script);
  } else {
    initWidget();
  }
}

// Button click handlers
document.querySelectorAll(".cta-button").forEach((btn) => {
  btn.addEventListener("click", (e) => {
    e.preventDefault();
    const stepId = btn.closest(".step").id;
    if (!validateStep(stepId)) return;
    let cb = null;
    if (
      stepId === "step1" ||
      stepId === "step2" ||
      stepId === "step3" ||
      stepId === "step4"
    ) {
      cb = nextStep;
    } else if (stepId === "step5") {
      cb = startAnalysis;
    } else if (stepId === "step7") {
      if (!validateLeadForm()) return;
      cb = () => loadCalendlyWidget({
        name: formData.name,
        email: formData.email,
        phone: formData.phone
      });
    }
    if (cb) cb();
  });
});

function createBackButtons() {
  steps.forEach((step) => {
    if (step.id !== "step1" && !['step6', 'step7'].includes(step.id) && !step.querySelector(".back-button")) {
      const backBtn = document.createElement("button");
      backBtn.className = "back-button";
      backBtn.type = "button";
      backBtn.innerHTML = "← Back";
      step.insertBefore(backBtn, step.firstElementChild);
      backBtn.addEventListener("click", (e) => {
        e.preventDefault();
        previousStep();
      });
    }
  });
}
createBackButtons();

const sliderContent = [
  { title: "Slides Of What Is Inside Of An AI Report", desc: "" },
  { title: "Slides Of What Is Inside Of An AI Report", desc: "" },
  { title: "Slides Of What Is Inside Of An AI Report", desc: "" },
  { title: "Slides Of What Is Inside Of An AI Report", desc: "" },
];
let currentSlideIdx = 0;
const slideContainer = document.getElementById("slideContent");
function updateSlider() {
  slideContainer.innerHTML = `<div class="slide-title">${sliderContent[currentSlideIdx].title}</div><div class="slide-desc">${sliderContent[currentSlideIdx].desc}</div>`;
  currentSlideIdx = (currentSlideIdx + 1) % sliderContent.length;
}
updateSlider();
setInterval(updateSlider, 4000);

const websiteUrlInput = document.getElementById("websiteUrl");
websiteUrlInput.addEventListener("input", (e) => {
  let value = e.target.value.trim();
  if (value && !/^https?:\/\//i.test(value)) {
    if (!e.target.dataset.isProcessing) {
      e.target.dataset.isProcessing = "true";
      const cursorPosition = e.target.selectionStart;
      const beforeCursor = value.slice(0, cursorPosition);
      const afterCursor = value.slice(cursorPosition);
      e.target.value = "https://" + value;
      const newCursorPosition = cursorPosition + "https://".length;
      e.target.setSelectionRange(newCursorPosition, newCursorPosition);
      setTimeout(() => {
        e.target.dataset.isProcessing = "";
      }, 0);
    }
  }
});
    </script>
  </body>
</html>
